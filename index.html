<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Controls</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
    	<div class="row">
    		<br>
    	</div>
    	<div class="row">
    		<div class="col-xs-4 col-lg-2">
    			<button type="button" class="on-button btn btn-success col-xs-12">On</button>
    		</div>
    		<div class="col-xs-4 col-lg-2">
    			<button type="button" class="off-button btn btn-danger col-xs-12">Off</button>
    		</div>
    		<div class="col-xs-4 col-lg-2">
    			<button type="button" class="blink-button btn btn-default col-xs-12">Blink</button>
    		</div>
    	</div>
    	<br>
    	
	</div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script>

    DEVICE_ID = "51ff6d065082554947550887";
    ACCESS_TOKEN = "761205dbf4c892c4cec15349f1e8db1956051036";
    HOST = "https://api.particle.io";

    var turnOnOutlet = function(index, element) {
    	$(element).button('loading');
    	$.ajax({
    		url: HOST + "/v1/devices/" + DEVICE_ID + "/on",
    		headers: {'Authorization': "Bearer " + ACCESS_TOKEN},
    		method: "POST",
    		data: {'arg': index},
    		complete: function(xhr, status) {
    			$(element).button('reset');
    		}
    	});
    };

    var turnOffOutlet = function(index, element) {
    	$(element).button('loading');
    	$.ajax({
    		url: HOST + "/v1/devices/" + DEVICE_ID + "/off",
    		headers: {'Authorization': "Bearer " + ACCESS_TOKEN},
    		method: "POST",
    		data: {'arg': index},
    		complete: function(xhr, status) {
    			$(element).button('reset');
    		}
    	});
    };

    var blinkOutlet = function(index, element) {
    	$(element).button('loading');
    	$.ajax({
    		url: HOST + "/v1/devices/" + DEVICE_ID + "/blink",
    		headers: {'Authorization': "Bearer " + ACCESS_TOKEN},
    		method: "POST",
    		data: {'arg': index},
    		complete: function(xhr, status) {
    			$(element).button('reset');
    		}
    	});
    };

    $(document).ready(function() {
    	$(".on-button").each(function(index, element) {
    		$(element).click(function() {
    			turnOnOutlet(index, element);
    		});
    	});
    	$(".off-button").each(function(index, element) {
    		$(element).click(function() {
    			turnOffOutlet(index, element);
    		});
    	});
    	$(".blink-button").each(function(index, element) {
    		$(element).click(function() {
    			blinkOutlet(index, element);
    		});
    	});
    });
    </script>
  </body>
</html>